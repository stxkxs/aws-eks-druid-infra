apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "druid.name" . }}-druid-broker-conf
  labels:
    {{- include "broker.labels" . | indent 4 }}
  annotations:
    {{- include "broker.annotations" . | indent 4 }}
data:
  "log4j2.xml":
    {{- .Files.Get "common/log4j2.xml" | toYaml | indent 4 }}
  "jvm.config":
    {{- if .Values.broker.jvm }}
    {{- printf "%s\n%s" (.Files.Get "common/jvm.config") .Values.broker.jvm | toYaml | indent 4 }}
    {{- else}}
    {{- .Files.Get "common/jvm.config" | toYaml | indent 4 }}
    {{- end }}
  "runtime.properties":
    {{- .Values.broker.runtime | toYaml | indent 4 }}
